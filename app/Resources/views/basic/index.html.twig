{% extends 'base.html.twig' %}

{% block title %}Welcome{% endblock %}

{% block body %}
    <div class="row" id="choose-graph">
        <div class="col-md-12">
            Choose graph
        </div>
    </div>
    <div class="row" id="graph-designer">
        <div class="col-md-12" id="control-buttons">
            <div class="btn-group" role="group" aria-label="Modify Your Graph">
                <div class="btn btn-success btn-xs" id="AddPoint">Add</div>
                <div class="btn btn-danger btn-xs" id="RemovePoint">Remove</div>
                <div class="btn btn-default btn-xs">Point</div>
            </div>
            <div class="btn-group" role="group" aria-label="Modify Your Graph">
                <div class="btn btn-success btn-xs" id="AddConnection">Add</div>
                <div class="btn btn-danger btn-xs" id="RemoveConnection">Remove</div>
                <div class="btn btn-default btn-xs">Connection</div>
            </div>
            <div class="btn btn-warning btn-xs pull-right" id="save-graph">Save</div>
        </div>
        <div class="col-md-12" id="canvas-area">
            {# canvas area #}
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    <script type="text/javascript">
        $(document).ready(function () {
            if ($('#graphs-list .list-group-item.active').length == 0) {
                $('#choose-graph').css('display', 'block');
            } else {
                $('#graph-designer').css('display', 'block');
            }

            _Stage.create();

            $('div#control-buttons div.btn-group div').on('click', function () {
                _Action.change($(this).attr('id'));
            });

            $('div#canvas-area').on('contextmenu', function () {
                _Action.toDefault();
                return false;
            })
            .on('click', function (event) {
                if (_Action.currentIs('addpoint')) {
                    _Points.add(event.offsetX, event.offsetY);
                }
            });

            $('div#control-buttons div.btn#save-graph').on('click', function () {
                _Action.toDefault();

                $.ajax({
                    data: 'graphName=' + $('#graphs-list .list-group .active').text() + '&points=' + _Points.toSave() + '&connections=' + _Connections.toSave(),
                    dataType: 'json',
                    url: '/save-graph',
                    method: 'post',
                    success: function (data) {
                        if (data.success) {
                            
                        } else {
                            
                        }
                    }
                });
            });
        });
    </script>
{% endblock %}
